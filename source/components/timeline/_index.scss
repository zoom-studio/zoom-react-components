@import 'mixins';

$items-container-gap: 100px;

.zoomrc-timeline {
  display: flex;
  flex-direction: column;

  &-sticky-title {
    > .header {
      position: sticky;
      top: 0;
      background-color: color(layer, 1);
      z-index: 2;
    }
  }

  > .header {
    padding: 10px 6px;
    border-bottom: 1px solid color(border, 2);
    color: color(text, 1);

    > .header-title {
      margin: 0;
    }
  }

  > .zoomrc-scroll-view {
    padding: 6px;

    > .os-viewport {
      display: flex;
      flex-direction: column;

      > .timeline-item {
        display: flex;
        gap: 10px;

        @each $variant in $common-variants {
          @include zoomrc-generate-timeline-item-variant($variant);
        }

        &:not(:last-child) {
          > .item-sign,
          > .content {
            padding-bottom: $items-container-gap;
          }

          > .item-sign {
            &::before {
              content: '';
              width: 2px;
              height: calc(100% - 50px);
              position: absolute;
              bottom: 5px;
              left: 0;
              right: 0;
              margin: auto;
              background-color: color(border, 2);
            }
          }
        }

        > .item-sign {
          position: relative;

          > .sign {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            border: 2px solid color(border, 2);
            padding: 4px;
            color: color(text, 3);

            &.icon-sign {
              font-size: to-rem(30px);
            }

            &.number-sign {
              margin: 0;
              font-size: to-rem(30px);
            }

            &.emoji-sign {
              width: 100%;
            }

            &.continues-sign {
              width: 20px;
              height: 20px;
              margin: 0 10px 30px;
              position: relative;

              &::after,
              &::before {
                content: '';
                background-color: color(border, 2);
                border-radius: 50%;
                position: absolute;
                margin: auto;
                left: 0;
                right: 0;
                width: 6px;
                height: 6px;
              }

              &::before {
                top: 24px;
              }

              &::after {
                top: 34px;
              }

              > .continues-spin {
                > .spinner {
                  width: 10px;
                  height: 10px;
                }
              }
            }
          }
        }

        > .content {
          flex: 1;
          display: flex;
          flex-direction: column;
          gap: 6px;

          > .datetime {
            background-color: color(accent);
            width: fit-content;
            padding: 2px 6px;
            border-radius: 4px;
            margin: 8px 0;

            > .datetime-children {
              margin: 0;
              color: white;
            }
          }

          > .body {
            background-color: color(layer, 2);
            border: 1px solid color(border, 2);
            border-radius: 4px;
            padding: 6px;
          }

          > .state-message {
            margin: 0;
            color: color(text, 3);
          }
        }

        &.done {
          > .item-sign {
            &::before {
              background-color: color(accent);
            }

            > .sign {
              border-color: color(accent);
            }
          }
        }

        &.in-progress {
          > .item-sign {
            > .sign {
              border-color: color(accent);
              border-style: dashed;
            }
          }
        }
      }
    }
  }

  &-reverse {
    &.zoomrc-timeline-column {
      > .zoomrc-scroll-view {
        > .os-viewport {
          flex-direction: column-reverse;

          > .timeline-item {
            align-items: flex-end;

            &:not(:last-child) {
              > .item-sign,
              > .content {
                padding-top: $items-container-gap;
                padding-bottom: 0;
              }

              > .item-sign {
                &::before {
                  bottom: unset;
                  top: 5px;
                }
              }
            }

            > .item-sign,
            > .content {
              height: 100%;
            }

            > .content {
              flex-direction: column-reverse;
            }

            > .item-sign {
              display: flex;
              align-items: flex-end;

              > .sign {
                &.continues-sign {
                  margin-bottom: 0;
                  margin-top: 30px;

                  &::before {
                    bottom: 24px;
                    top: unset;
                  }

                  &::after {
                    bottom: 34px;
                    top: unset;
                  }
                }
              }
            }
          }
        }
      }
    }
  }

  &-row {
    > .zoomrc-scroll-view {
      > .os-viewport {
        flex-direction: row;
        gap: $items-container-gap;

        > .timeline-item {
          &:not(.continues) {
            min-width: 300px;
          }

          &:not(:last-child) {
            > .item-sign,
            > .content {
              padding-top: 0;
              padding-bottom: 0;
            }

            > .content {
              position: relative;

              > * {
                position: relative;
                z-index: 1;
              }

              &::before {
                content: '';
                width: calc(100% + $items-container-gap);
                height: 2px;
                background-color: color(border, 2);
                top: 20px;
                position: absolute;
                left: -5px;
              }
            }

            > .item-sign {
              &::before {
                content: unset;
              }
            }
          }

          > .item-sign {
            > .sign {
              &.continues-sign {
                margin: 10px 0;
                margin-inline-end: 30px;

                &::before,
                &::after {
                  bottom: 0;
                  top: 0;
                }

                &::before {
                  left: 24px;
                }

                &::after {
                  left: 34px;
                }
              }
            }
          }
        }
      }
    }
  }
}

@include rtl {
  .zoomrc-timeline {
    &-row {
      > .zoomrc-scroll-view {
        > .os-viewport {
          > .timeline-item {
            &:not(:last-child) {
              > .content {
                &::before {
                  left: unset;
                  right: -5px;
                }
              }
            }

            > .item-sign {
              > .sign {
                &.continues-sign {
                  &::before,
                  &::after {
                    left: unset;
                  }

                  &::before {
                    right: 24px;
                  }

                  &::after {
                    right: 34px;
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
